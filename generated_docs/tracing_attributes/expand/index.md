*[tracing_attributes](../index.md) / [expand](index.md)*

---

# Module `expand`

## Structs

### `AsyncInfo<'block>`

```rust
struct AsyncInfo<'block> {
    source_stmt: &'block syn::Stmt,
    kind: AsyncKind<'block>,
    self_type: Option<syn::TypePath>,
    input: &'block syn::ItemFn,
}
```

#### Implementations

- `fn from_fn(input: &'block ItemFn) -> Option<Self>`

- `fn gen_async(self: Self, args: InstrumentArgs, instrumented_function_name: &str) -> Result<proc_macro::TokenStream, syn::Error>` â€” [`InstrumentArgs`](../attr/index.md)

### `IdentAndTypesRenamer<'a>`

```rust
struct IdentAndTypesRenamer<'a> {
    types: Vec<(&'a str, syn::TypePath)>,
    idents: Vec<(syn::Ident, syn::Ident)>,
}
```

A visitor struct to replace idents and types in some piece
of code (e.g. the "self" and "Self" tokens in user-supplied
fields expressions when the function is generated by an old
version of async-trait).

#### Trait Implementations

##### `impl VisitMut for IdentAndTypesRenamer<'_>`

- `fn visit_ident_mut(self: &mut Self, id: &mut Ident)`

- `fn visit_type_mut(self: &mut Self, ty: &mut Type)`

### `ImplTraitEraser`

```rust
struct ImplTraitEraser;
```

#### Trait Implementations

##### `impl VisitMut for ImplTraitEraser`

- `fn visit_type_mut(self: &mut Self, t: &mut Type)`

## Enums

### `RecordType`

```rust
enum RecordType {
    Value,
    Debug,
}
```

Indicates whether a field should be recorded as `Value` or `Debug`.

#### Variants

- **`Value`**

  The field should be recorded using its `Value` implementation.

- **`Debug`**

  The field should be recorded using `tracing::field::debug()`.

#### Implementations

- `const TYPES_FOR_VALUE: &'static [&'static str]`

- `fn parse_from_ty(ty: &Type) -> Self`

### `AsyncKind<'a>`

```rust
enum AsyncKind<'a> {
    Function(&'a syn::ItemFn),
    Async {
        async_expr: &'a syn::ExprAsync,
        pinned_box: bool,
    },
}
```

The specific async code pattern that was detected

#### Variants

- **`Function`**

  Immediately-invoked async fn, as generated by `async-trait <= 0.1.43`:
  `async fn foo<...>(...) {...}; Box::pin(foo<...>(...))`

- **`Async`**

  A function returning an async (move) block, optionally `Box::pin`-ed,
  as generated by `async-trait >= 0.1.44`:
  `Box::pin(async move { ... })`

## Functions

### `gen_function`

```rust
fn gen_function<'a, B: ToTokens + 'a>(input: crate::MaybeItemFnRef<'a, B>, args: crate::attr::InstrumentArgs, instrumented_function_name: &str, self_type: Option<&syn::TypePath>) -> proc_macro2::TokenStream
```

Given an existing function, generate an instrumented version of that function

### `gen_block`

```rust
fn gen_block<B: ToTokens>(block: &B, params: &syn::punctuated::Punctuated<syn::FnArg, $crate::token::Comma>, async_context: bool, args: crate::attr::InstrumentArgs, instrumented_function_name: &str, self_type: Option<&syn::TypePath>) -> proc_macro2::TokenStream
```

Instrument a block

### `param_names`

```rust
fn param_names(pat: syn::Pat, record_type: RecordType) -> Box<dyn Iterator<Item = (syn::Ident, RecordType)>>
```

### `path_to_string`

```rust
fn path_to_string(path: &syn::Path) -> String
```

### `erase_impl_trait`

```rust
fn erase_impl_trait(ty: &syn::Type) -> syn::Type
```

